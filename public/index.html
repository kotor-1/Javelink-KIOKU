<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåä KIOKU JAVELINK - „Ç∏„É£„ÉôÂÖ®Á®ÆÁõÆËß£Êûê</title>
    <link rel="icon" href="data:,">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Noto+Sans+JP:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            overflow-x: hidden;
            background: linear-gradient(180deg, #87CEEB 0%, #98D8E8 50%, #FFF8DC 100%);
            min-height: 100vh;
            position: relative;
        }
        
        /* Â§™ÈôΩ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .sun {
            position: fixed;
            top: 50px;
            right: 50px;
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #FFD700, #FFA500);
            border-radius: 50%;
            box-shadow: 0 0 50px #FFD700;
            animation: pulse 4s ease-in-out infinite;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .sun:hover {
            transform: scale(1.2) rotate(180deg);
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 50px #FFD700; }
            50% { box-shadow: 0 0 80px #FFA500; }
        }
        
        /* Ê≥¢„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .ocean {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 150px;
            background: linear-gradient(180deg, transparent, #1E90FF);
            z-index: 1;
        }
        
        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 200%;
            height: 100px;
            background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 320'%3E%3Cpath fill='%234A90E2' fill-opacity='0.8' d='M0,96L48,112C96,128,192,160,288,160C384,160,480,128,576,122.7C672,117,768,139,864,133.3C960,128,1056,96,1152,96C1248,96,1344,128,1392,144L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z'%3E%3C/path%3E%3C/svg%3E");
            background-size: 50% 100px;
            animation: wave 10s linear infinite;
            opacity: 0.8;
        }
        
        .wave:nth-child(2) {
            animation-delay: -5s;
            opacity: 0.6;
            bottom: 10px;
        }
        
        .wave:nth-child(3) {
            animation-delay: -2s;
            opacity: 0.4;
            bottom: 20px;
        }
        
        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        /* Èõ≤„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .cloud {
            position: fixed;
            background: white;
            border-radius: 100px;
            opacity: 0.7;
            animation: float 20s infinite ease-in-out;
        }
        
        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: white;
            border-radius: 100px;
        }
        
        .cloud1 {
            width: 100px;
            height: 40px;
            top: 20%;
            left: -100px;
            animation-duration: 25s;
        }
        
        .cloud1::before {
            width: 50px;
            height: 50px;
            top: -25px;
            left: 10px;
        }
        
        .cloud1::after {
            width: 60px;
            height: 40px;
            top: -15px;
            right: 10px;
        }
        
        .cloud2 {
            width: 80px;
            height: 35px;
            top: 40%;
            left: -80px;
            animation-duration: 30s;
            animation-delay: -10s;
        }
        
        @keyframes float {
            0% { transform: translateX(0); }
            100% { transform: translateX(calc(100vw + 200px)); }
        }
        
        /* „Ç∏„É£„Éô„É™„ÉÉ„ÇØÁî®ÂìÅ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .javelin-item {
            position: fixed;
            animation: float-items 15s infinite ease-in-out;
            z-index: 5;
            cursor: pointer;
            transition: transform 0.3s;
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.3));
            display: block !important; /* Á¢∫ÂÆü„Å´Ë°®Á§∫ */
            opacity: 1; /* ÈÄèÊòéÂ∫¶„ÇíÁ¢∫ÂÆü„Å´Ë®≠ÂÆö */
        }
        
        .javelin-item:hover {
            transform: scale(1.2);
            filter: drop-shadow(0 8px 20px rgba(0,0,0,0.4));
        }
        
        @keyframes float-items {
            0%, 100% { 
                transform: translateY(0) translateX(0);
            }
            25% { 
                transform: translateY(-20px) translateX(10px);
            }
            50% { 
                transform: translateY(10px) translateX(-10px);
            }
            75% { 
                transform: translateY(-15px) translateX(5px);
            }
        }
        
        /* „Ç´„É¢„É° */
        .seagull {
            position: fixed;
            top: 15%;
            animation: fly 15s infinite ease-in-out;
            font-size: 30px;
            transform: scaleX(-1);
        }
        
        @keyframes fly {
            0% { left: -50px; top: 15%; }
            25% { top: 10%; }
            50% { left: 100%; top: 20%; }
            75% { top: 12%; }
            100% { left: -50px; top: 15%; }
        }
        
        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
            position: relative;
            z-index: 10;
        }
        
        /* „Çø„Ç§„Éà„É´ */
        .title-container {
            text-align: center;
            margin-bottom: 3rem;
            animation: slideDown 1s ease-out;
        }
        
        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .main-title {
            font-family: 'Bebas Neue', cursive;
            font-size: 4rem;
            background: linear-gradient(45deg, #FF6B35, #F7931E, #FFD700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 0.5rem;
            letter-spacing: 3px;
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { filter: brightness(1); }
            to { filter: brightness(1.2); }
        }
        
        .subtitle {
            color: #2C3E50;
            font-size: 0.95rem;
            font-weight: 700;
        }
        
        /* „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº/„Çπ„É©„Ç§„ÉÄ„ÉºË£ÖÈ£æ */
        .progress-slider {
            width: 100%;
            height: 4px;
            background: rgba(255, 107, 53, 0.2);
            border-radius: 2px;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }
        
        .progress-slider::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 60%;
            background: linear-gradient(90deg, #FF6B35, #FFD700);
            border-radius: 2px;
            animation: slide-progress 3s ease-in-out infinite;
        }
        
        @keyframes slide-progress {
            0%, 100% { width: 20%; }
            50% { width: 80%; }
        }
        
        /* „Çµ„Éº„Éï„Éú„Éº„ÉâÂûã„ÅÆ„Ç´„Éº„Éâ */
        .surfboard-card {
            background: linear-gradient(135deg, #FFFAFA 0%, #F0FFFF 100%);
            border-radius: 150px 150px 30px 30px;
            padding: 3rem 2rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
            animation: float-card 3s ease-in-out infinite;
            border: 3px solid #FFD700;
        }
        
        @keyframes float-card {
            0%, 100% { transform: translateY(0) rotate(-1deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
        }
        
        /* „Çµ„Éº„Éï„Éú„Éº„Éâ„ÅÆÊ®°Êßò */
        .surfboard-card::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -50%;
            width: 200%;
            height: 3px;
            background: linear-gradient(90deg, transparent, #FFD700, transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }
        
        @keyframes shine {
            0% { left: -50%; }
            100% { left: 150%; }
        }
        
        /* „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Ç®„É™„Ç¢ */
        .upload-zone {
            background: radial-gradient(circle at center, rgba(64, 224, 208, 0.1), rgba(30, 144, 255, 0.1));
            border: 3px dashed #40E0D0;
            border-radius: 30px;
            padding: 4rem 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .upload-zone:hover {
            background: radial-gradient(circle at center, rgba(64, 224, 208, 0.2), rgba(30, 144, 255, 0.2));
            transform: scale(1.02);
            border-color: #FF6B35;
        }
        
        .upload-zone.dragover {
            background: radial-gradient(circle at center, rgba(255, 107, 53, 0.2), rgba(255, 215, 0, 0.2));
            border-color: #FF6B35;
            animation: pulse-border 1s infinite;
        }
        
        @keyframes pulse-border {
            0%, 100% { border-width: 3px; }
            50% { border-width: 5px; }
        }
        
        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        
        .upload-text {
            font-size: 1.3rem;
            color: #2C3E50;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        .upload-subtext {
            color: #5A6C7D;
            font-size: 0.9rem;
        }
        
        /* „Éì„Éá„Ç™„Éó„É¨„Éì„É•„Éº */
        .video-container {
            display: none;
            position: relative;
            z-index: 50;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .video-container video {
            width: 100%;
            height: auto;
            aspect-ratio: 16/9;
            display: block;
            background: #000;
        }
        
        /* Ëß£Êûê„Éú„Çø„É≥ */
        .analyze-button {
            display: none;
            background: linear-gradient(135deg, #FF6B35, #FFD700);
            color: white;
            border: none;
            padding: 1.5rem 3rem;
            font-size: 1.3rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin: 2rem auto;
            box-shadow: 0 10px 30px rgba(255, 107, 53, 0.3);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .analyze-button:hover:not(:disabled) {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 15px 40px rgba(255, 107, 53, 0.4);
        }
        
        .analyze-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .analyze-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        .analyze-button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        /* „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº */
        .progress-container {
            display: none;
            margin: 2rem 0;
        }
        
        .progress-wave {
            height: 60px;
            background: #E8F4F8;
            border-radius: 30px;
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #40E0D0, #4A90E2, #1E90FF);
            background-size: 200% 100%;
            animation: gradient 2s ease infinite;
            transition: width 0.3s;
            position: relative;
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #2C3E50;
            font-weight: bold;
            font-size: 1.2rem;
            z-index: 10;
        }
        
        /* ÁµêÊûúË°®Á§∫ */
        .results-container {
            display: none;
            animation: slideUp 0.5s ease-out;
        }
        
        @keyframes slideUp {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .results-title {
            text-align: center;
            font-size: 2rem;
            color: #FF6B35;
            margin-bottom: 2rem;
            font-weight: bold;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .result-item {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
            min-height: 180px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .result-item:hover {
            transform: translateY(-5px) scale(1.05);
            border-color: #FFD700;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .result-item::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 215, 0, 0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }
        
        .result-item:hover::before {
            animation: shimmer 0.5s;
        }
        
        @keyframes shimmer {
            0% { transform: rotate(45deg) translateY(-100%); }
            100% { transform: rotate(45deg) translateY(100%); }
        }
        
        .result-label {
            color: #5A6C7D;
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }
        

        
        .result-value-unit {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.25rem;
            margin: 0.5rem 0;
        }
        
        .result-value-unit .result-value {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #FF6B35, #FFD700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }
        
        .result-value-unit .result-unit {
            font-size: 1.5rem;
            font-weight: 600;
            color: #7F8C8D;
            margin: 0;
        }
        
        .result-description {
            color: #7F8C8D;
            font-size: 0.75rem;
            margin-top: 0.5rem;
            line-height: 1.3;
            text-align: center;
            font-style: italic;
        }
        

        
        /* Ë∑ùÈõ¢ÂÖ•Âäõ */
        .distance-section {
            background: linear-gradient(135deg, #FFF8DC, #F0FFFF);
            border-radius: 20px;
            padding: 2rem;
            margin-top: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .distance-label {
            display: block;
            color: #2C3E50;
            font-weight: bold;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        .distance-input {
            width: 100%;
            padding: 1rem;
            font-size: 1.5rem;
            border: 2px solid #40E0D0;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s;
            background: white;
        }
        
        .distance-input:focus {
            outline: none;
            border-color: #FF6B35;
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.2);
            transform: scale(1.02);
        }
        
        /* „Éì„Éº„ÉÅ„Éú„Éº„É´Ë£ÖÈ£æ */
        .beach-ball {
            position: fixed;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: conic-gradient(
                from 0deg,
                #FF6B35 0deg 60deg,
                white 60deg 120deg,
                #40E0D0 120deg 180deg,
                white 180deg 240deg,
                #FFD700 240deg 300deg,
                white 300deg 360deg
            );
            animation: roll 20s linear infinite;
            cursor: pointer;
        }
        
        .beach-ball1 {
            bottom: 100px;
            left: 10%;
            animation-delay: 0s;
        }
        
        .beach-ball2 {
            bottom: 150px;
            right: 15%;
            animation-delay: -10s;
        }
        
        @keyframes roll {
            0% {
                transform: translateX(0) rotate(0deg);
            }
            100% {
                transform: translateX(100px) rotate(360deg);
            }
        }
        
        /* „É¨„Çπ„Éù„É≥„Ç∑„Éñ */
        @media (max-width: 768px) {
            .main-title {
                font-size: 3rem;
            }
            
            .surfboard-card {
                padding: 2rem 1rem;
                border-radius: 50px 50px 20px 20px;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Èö†„ÅóË¶ÅÁ¥† */
        input[type="file"] {
            display: none;
        }
        
        canvas {
            display: none;
        }

        /* ÂãïÁîªÊúÄÈÅ©ÂåñÊÉÖÂ†± */
        .optimization-info {
            background: linear-gradient(135deg, #F0F8FF 0%, #E6F3FF 100%);
            border: 2px solid #40E0D0;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: slideDown 0.5s ease-out;
        }
        
        .optimization-header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1rem;
        }
        
        .optimization-icon {
            font-size: 2rem;
            margin-right: 0.5rem;
            animation: pulse 2s infinite;
        }
        
        .optimization-title {
            font-size: 1.2rem;
            font-weight: bold;
            color: #2C3E50;
        }
        
        .optimization-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 0.8rem;
            text-align: left;
        }
        
        .optimization-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            border: 1px solid rgba(64, 224, 208, 0.3);
        }
        
        .label {
            font-size: 0.9rem;
            color: #5A6C7D;
            font-weight: 600;
        }
        
        .value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #FF6B35;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .special-note {
            background: linear-gradient(135deg, #FFF8DC, #FFE4B5);
            border: 2px solid #FFD700;
        }
        
        .special-note .value {
            color: #FF8C00;
            font-weight: bold;
        }
        
        /* „É≠„Éº„Éá„Ç£„É≥„Ç∞„Éê„Éº */
        .loading-progress {
            width: 100%;
            height: 8px;
            background: rgba(64, 224, 208, 0.2);
            border-radius: 4px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .loading-bar {
            height: 100%;
            background: linear-gradient(90deg, #40E0D0, #4A90E2, #1E90FF);
            background-size: 200% 100%;
            animation: loading-animation 2s ease-in-out infinite;
            width: 100%;
        }
        
        @keyframes loading-animation {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* ========== „É¢„Éê„Ç§„É´ÊúÄÈÅ©ÂåñÔºà‚â§430pxÔºâ ========== */
        @media (max-width: 430px) {
            :root { 
                --pad: 12px; 
                --gap: 10px; 
                --radius: 12px; 
            }
            
            body { 
                padding: var(--pad); 
                font-size: clamp(12px, 3.5vw, 14px);
            }
            
            /* „Çø„Ç§„Éà„É´„ÅØ2Ë°å„Åæ„ÅßË®±ÂÆπÔºàPCÊ∫ñÊã†Ôºâ */
            .title-container { 
                margin: 8px 0 10px; 
                text-align: center;
            }
            
            .main-title { 
                font-size: clamp(18px, 5.2vw, 22px); 
                letter-spacing: 1px; 
                margin: 0; 
                line-height: 1.2;
            }
            
            .subtitle { 
                display: block; 
                font-size: clamp(12px, 3.4vw, 14px); 
                margin-top: 4px;
            }
            
            /* ËÉåÊôØÊºîÂá∫„ÅØËªΩÈáèÂåñÔºöÊµ∑/Èõ≤„ÅØÈùûË°®Á§∫„Åß„ÇÇOK„Å†„Åå„ÄÅÁ´∂ÊäÄSVG„ÅØË°®Á§∫ */
            .sun, .cloud, .ocean, .wave, .seagull { 
                display: none !important; 
            }
            
            /* „Éì„Éº„ÉÅ„Éú„Éº„É´„ÅØË°®Á§∫ */
            .beach-ball { 
                display: block !important; 
                animation: none !important;
                opacity: 0.8;
            }
            
            /* Á´∂ÊäÄSVG„ÅØË°®Á§∫ÔºàÈùôÊ≠¢Êé®Â•®Ôºâ */
            .javelin-item { 
                display: block !important; 
                animation: none !important; 
                z-index: 3; 
                opacity: 0.9;
                position: fixed !important;
                visibility: visible !important;
            }
            
            .javelin-ball, .turbo-jav, .javelin-spear { 
                display: block !important; 
                visibility: visible !important;
                opacity: 1 !important;
            }
            
            /* „Ç≥„É≥„ÉÜ„Éä„Å®„Ç´„Éº„Éâ */
            .surfboard-card { 
                padding: 12px; 
                border-radius: 12px; 
                box-shadow: 0 2px 8px rgba(0,0,0,0.06);
                margin: 0;
            }
            
            /* „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Çæ„Éº„É≥ */
            .upload-zone { 
                padding: 18px 12px; 
                border-radius: var(--radius); 
                margin: var(--gap) 0;
            }
            
            /* ÂãïÁîª„Éó„É¨„Éì„É•„Éº */
            .video-container { 
                display: block; 
                background: #000; 
                border-radius: 8px; 
                overflow: hidden; 
                margin: var(--gap) 0;
            }
            
            .video-container video { 
                width: 100%; 
                height: auto; 
                aspect-ratio: 16/9; 
                max-height: min(36vh, 240px); 
                border-radius: 0;
            }
            
            /* Ë∫´Èï∑ÂÖ•ÂäõÔºà„É¢„Éê„Ç§„É´„Åß„ÅØÈùûË°®Á§∫Ôºâ */
            .height-input-row { 
                display: none; 
            }
            
            /* Ë®≠ÂÆö„Éú„Çø„É≥ÔºàÂè≥‰∏äÔºâ */
            .settings-trigger { 
                position: absolute; 
                top: 6px; 
                right: 6px; 
                font-size: 18px; 
                background: rgba(255,255,255,0.9);
                border-radius: 50%;
                width: 32px;
                height: 32px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 10;
            }
            
            /* Ëß£Êûê„Éú„Çø„É≥ */
            .analyze-button { 
                width: 100%; 
                height: 44px; 
                padding: 0 12px; 
                border-radius: 999px; 
                font-size: 14px; 
                margin: var(--gap) 0; 
                min-height: 36px;
            }
            
            /* „É°„Éº„Çø„Éº */
            #meters { 
                display: grid; 
                gap: 6px; 
                margin: var(--gap) 0;
            }
            
            #meters .bar { 
                height: 10px; 
                border-radius: 999px; 
                overflow: hidden; 
                background: #E9EEF5; 
            }
            
            #meters .fill { 
                height: 100%; 
                width: 0%; 
                background: linear-gradient(90deg, #41DAB5, #4AA3FF); 
                transition: width 0.3s ease;
            }
            
            /* ÁµêÊûú„ÅØ2Âàó‰ª•‰∏ä */
            .results-container { 
                margin-top: var(--gap); 
            }
            
            .results-title { 
                font-size: clamp(16px, 4.5vw, 18px);
                margin-bottom: var(--gap);
            }
            
            .results-grid {
                display: grid;
                grid-template-columns: repeat(2, minmax(0, 1fr));
                gap: 10px;
                margin: var(--gap) 0; 
                padding: 0;
            }
            
            .result-item {
                border-radius: 12px; 
                padding: 10px; 
                box-shadow: 0 2px 8px rgba(0,0,0,0.06);
                background: #fff;
                border: 1px solid #E5E7EB;
            }
            
            .result-label { 
                font-size: clamp(12px, 3.3vw, 14px); 
                color: #374151; 
                margin-bottom: 4px;
            }
            
            .result-value-unit .result-value { 
                font-size: clamp(18px, 5vw, 22px); 
                font-weight: 700; 
                background: none; 
                -webkit-text-fill-color: currentColor; 
                color: #2C3E50;
            }
            
            .result-value-unit .result-unit { 
                font-size: clamp(12px, 3.3vw, 13px); 
                color: #6B7280; 
            }
            
            /* Ë™¨Êòé„ÉÜ„Ç≠„Çπ„Éà„ÇíË°®Á§∫ÔºàÁúÅÁï•„Åó„Å™„ÅÑÔºâ */
            .result-description, .result-desc { 
                display: block; 
                font-size: clamp(11px, 3.1vw, 13px); 
                color: #6B7280; 
                margin-top: 4px; 
                line-height: 1.3;
            }
            
            /* Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ */
            .settings-modal { 
                display: none; 
                position: fixed; 
                top: 0; 
                left: 0; 
                width: 100%; 
                height: 100%; 
                background: rgba(0,0,0,0.5); 
                z-index: 1000;
            }
            
            .settings-modal.show { 
                display: flex; 
                align-items: center; 
                justify-content: center; 
            }
            
            .settings-content { 
                background: white; 
                border-radius: 12px; 
                padding: 16px; 
                width: 92vw; 
                max-width: 360px; 
                max-height: 80vh; 
                overflow-y: auto;
            }
            
            .settings-header { 
                display: flex; 
                justify-content: space-between; 
                align-items: center; 
                margin-bottom: 16px; 
                padding-bottom: 8px; 
                border-bottom: 1px solid #E5E7EB;
            }
            
            .settings-close { 
                background: none; 
                border: none; 
                font-size: 20px; 
                cursor: pointer; 
                color: #6B7280;
            }
            
            /* ÂÖ•Âäõ„ÅÆ„Ç∫„Éº„É†ÊäëÊ≠¢ */
            #userHeight, input[type="number"], input[type="text"] {
                font-size: 16px;
                padding: 10px 12px;
                line-height: 1.2;
            }
        }
        
        /* „É¨„Ç§„É§È†Ü„ÅÆË™øÊï¥ÔºàPC/„É¢„Éê„Ç§„É´ÂÖ±ÈÄöÔºâ */
        .sun, .cloud, .ocean, .wave, .seagull { z-index: 1; }
        .javelin-item { z-index: 3; }
        .video-container, .surfboard-card, .results-container, .analyze-button { position: relative; z-index: 5; }
        
        /* „Ç∞„É≠„Éº„Éê„É´„Ç∫„Éº„É†Èò≤Ê≠¢ */
        html { -webkit-text-size-adjust: 100%; }
    </style>
</head>
<body>
    <!-- ËÉåÊôØË£ÖÈ£æ -->
    <div class="sun" onclick="toggleTheme()"></div>
    <div class="cloud cloud1"></div>
    <div class="cloud cloud2"></div>
    <div class="seagull">ü¶Ö</div>
    
    <!-- Ê≥¢„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ -->
    <div class="ocean">
        <div class="wave"></div>
        <div class="wave"></div>
        <div class="wave"></div>
    </div>
    
    <!-- „Ç∏„É£„Éô„É™„ÉÉ„ÇØÁî®ÂìÅ -->
    <svg class="javelin-item javelin-ball" title="„Ç∏„É£„Éô„É™„ÉÉ„ÇØ„Éú„Éº„É´" viewBox="0 0 150 100" style="width: 100px; height: 67px; top: 25%; left: 10%;">
        <!-- „Ç∏„É£„Éô„É™„ÉÉ„ÇØ„Éú„Éº„É´Êú¨‰Ωì -->
        <defs>
            <linearGradient id="bodyGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                <stop offset="0%" style="stop-color:#FFFFFF;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#F5F5F5;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#E0E0E0;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="tailFinGradient">
                <stop offset="0%" style="stop-color:#FF0000;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#DC143C;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#B22222;stop-opacity:1" />
            </linearGradient>
        </defs>
        
        <!-- Ëµ§„ÅÑÂ∞æÁøºÔºàÊîæÂ∞ÑÁä∂„ÅÆ3ÊûöÁæΩÊ†πÔºâ -->
        <!-- ‰∏ä„ÅÆÁæΩÊ†π -->
        <path d="M 40 50 L 15 50 L 10 35 L 15 40 L 35 48 Z" fill="url(#tailFinGradient)" />
        <!-- ‰∏ã„ÅÆÁæΩÊ†π -->
        <path d="M 40 50 L 15 50 L 10 65 L 15 60 L 35 52 Z" fill="url(#tailFinGradient)" />
        <!-- Ê®™„ÅÆÁæΩÊ†πÔºàÂÅ¥Èù¢Ôºâ -->
        <path d="M 40 50 L 15 50 L 12 45 L 12 55 L 15 50 Z" fill="#DC143C" opacity="0.8"/>
        
        <!-- ÁæΩÊ†π„ÅÆÊé•Á∂öÈÉ® -->
        <rect x="35" y="45" width="10" height="10" rx="2" fill="#B22222"/>
        
        <!-- ÁôΩ„ÅÑ„Éú„Éá„Ç£Ôºà„É≠„Ç±„ÉÉ„ÉàÂûãÔºâ -->
        <!-- „É°„Ç§„É≥„Éú„Éá„Ç£ -->
        <ellipse cx="75" cy="50" rx="40" ry="18" fill="url(#bodyGradient)"/>
        <!-- ÂÖàÁ´ØÈÉ®ÂàÜÔºàÂ∞ñ„Å£„ÅüÂΩ¢Ôºâ -->
        <path d="M 115 50 Q 125 50, 135 50 L 115 42 L 115 58 Z" fill="#F0F0F0"/>
        
        <!-- „Éú„Éá„Ç£„ÅÆ„É™„É≥„Ç∞Ê®°ÊßòÔºàÊ∫ùÔºâ -->
        <rect x="55" y="38" width="2" height="24" rx="1" fill="#D0D0D0" opacity="0.5"/>
        <rect x="62" y="38" width="2" height="24" rx="1" fill="#D0D0D0" opacity="0.5"/>
        <rect x="69" y="38" width="2" height="24" rx="1" fill="#D0D0D0" opacity="0.5"/>
        <rect x="76" y="38" width="2" height="24" rx="1" fill="#D0D0D0" opacity="0.5"/>
        <rect x="83" y="38" width="2" height="24" rx="1" fill="#D0D0D0" opacity="0.5"/>
        
        <!-- Ëµ§„ÅÑÂÜÜÂΩ¢„Éû„Éº„ÇØÔºà‰∏°„Çµ„Ç§„ÉâÔºâ -->
        <ellipse cx="95" cy="50" rx="7" ry="5" fill="#FF0000" opacity="0.9"/>
        <ellipse cx="60" cy="50" rx="7" ry="5" fill="#FF0000" opacity="0.9"/>
        
        <!-- Javeball „É≠„Ç¥ -->
        <text x="75" y="53" font-family="Arial Black" font-size="7" fill="#FF0000" text-anchor="middle" font-style="italic" font-weight="bold">JaveBall</text>
        
        <!-- „Éè„Ç§„É©„Ç§„Éà -->
        <ellipse cx="65" cy="43" rx="12" ry="4" fill="white" opacity="0.6"/>
    </svg>
    
    <svg class="javelin-item turbo-jav" title="„Çø„Éº„Éú„Ç∏„É£„Éñ" viewBox="0 0 300 60" style="width: 180px; height: 36px; top: 35%; right: 15%; transform: rotate(-30deg);">
        <!-- „Çø„Éº„Éú„Ç∏„É£„ÉñÊú¨‰Ωì -->
        <defs>
            <linearGradient id="turboGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#FF6B6B;stop-opacity:1" />
                <stop offset="20%" style="stop-color:#4ECDC4;stop-opacity:1" />
                <stop offset="40%" style="stop-color:#45B7D1;stop-opacity:1" />
                <stop offset="60%" style="stop-color:#96CEB4;stop-opacity:1" />
                <stop offset="80%" style="stop-color:#FFEAA7;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#DDA15E;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="tipGradient">
                <stop offset="0%" style="stop-color:#B0B0B0;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#808080;stop-opacity:1" />
            </linearGradient>
        </defs>
        <!-- „É°„Ç§„É≥„Éú„Éá„Ç£ -->
        <rect x="30" y="20" width="220" height="20" rx="10" fill="url(#turboGradient)"/>
        <!-- ÂÖàÁ´ØÔºàÈáëÂ±ûÈÉ®ÂàÜÔºâ -->
        <polygon points="250,30 280,30 290,25 290,35 280,30" fill="url(#tipGradient)"/>
        <!-- ÂæåÁ´ØÔºà„Ç∞„É™„ÉÉ„ÉóÔºâ -->
        <rect x="10" y="22" width="25" height="16" rx="8" fill="#333333"/>
        <rect x="15" y="25" width="5" height="10" fill="#FF6B6B"/>
        <rect x="22" y="25" width="5" height="10" fill="#4ECDC4"/>
        <!-- „ÉÜ„Ç≠„Çπ„Éà -->
        <text x="140" y="35" font-family="Arial Black" font-size="12" fill="white" text-anchor="middle">TURBO</text>
    </svg>
    
    <svg class="javelin-item javelin-spear" title="„ÇÑ„ÇäÊäï„Åí" viewBox="0 0 400 40" style="width: 200px; height: 20px; top: 20%; left: 50%; transform: rotate(45deg);">
        <!-- „ÇÑ„ÇäÊäï„ÅíÁî®„ÇÑ„Çä -->
        <defs>
            <linearGradient id="spearShaft" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#C0C0C0;stop-opacity:1" />
                <stop offset="10%" style="stop-color:#E8E8E8;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#FFFFFF;stop-opacity:1" />
                <stop offset="90%" style="stop-color:#E8E8E8;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#C0C0C0;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="spearTip">
                <stop offset="0%" style="stop-color:#808080;stop-opacity:1" />
                <stop offset="50%" style="stop-color:#A0A0A0;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#606060;stop-opacity:1" />
            </linearGradient>
        </defs>
        <!-- „Ç∑„É£„Éï„Éà -->
        <rect x="40" y="17" width="300" height="6" fill="url(#spearShaft)"/>
        <!-- „Ç∞„É™„ÉÉ„Éó„Ç≥„Éº„ÉâÔºàÂ∑ª„Åç‰ªò„ÅëÈÉ®ÂàÜÔºâ -->
        <rect x="160" y="16" width="60" height="8" fill="#2C3E50"/>
        <rect x="165" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="172" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="179" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="186" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="193" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="200" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="207" y="16" width="3" height="8" fill="#E74C3C"/>
        <rect x="214" y="16" width="3" height="8" fill="#E74C3C"/>
        <!-- ÂÖàÁ´Ø -->
        <polygon points="340,20 380,20 390,18 395,20 390,22 380,20 340,20" fill="url(#spearTip)"/>
        <!-- ÂæåÁ´Ø -->
        <ellipse cx="40" cy="20" rx="8" ry="6" fill="#808080"/>
    </svg>
    
    <div class="beach-ball beach-ball1"></div>
    <div class="beach-ball beach-ball2"></div>
    
    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <div class="container">
        <div class="title-container">
            <h1 class="main-title">üåä KIOKU JAVELINK</h1>
            <p class="subtitle">„Ç∏„É£„ÉôÂÖ®Á®ÆÁõÆËß£Êûê - ÊπòÂçó„Çπ„Çø„Ç§„É´</p>
            <div class="progress-slider"></div>
        </div>
        
        <div class="surfboard-card">
            <!-- Ë®≠ÂÆö„Éú„Çø„É≥Ôºà„É¢„Éê„Ç§„É´Áî®Ôºâ -->
            <div class="settings-trigger" id="settingsTrigger" style="display: none;">‚öô</div>
            
            <!-- „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Ç®„É™„Ç¢ -->
            <div class="upload-zone" id="uploadZone">
                <div class="upload-icon">üé•</div>
                <p class="upload-text">ÊäïÊì≤ÂãïÁîª„Çí„Éâ„É≠„ÉÉ„ÉóÔºÅ</p>
                <p class="upload-subtext">„Åæ„Åü„ÅØ„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈÅ∏Êäû (MP4, MOV, AVI, WebM)</p>
                <input type="file" id="videoFile" accept="video/*">
            </div>
            
            <!-- Ë∫´Èï∑ÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
            <div id="heightInputRow" style="display:block; margin:10px 0; padding:15px; background:#FFF8DC; border-radius:8px; border:2px solid #FFD700;">
                <div style="font-weight:700; color:#2C3E50; margin-bottom:10px;">üìè Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà„Çà„ÇäÊ≠£Á¢∫„Å™Ê∏¨ÂÆö„ÅÆ„Åü„ÇÅÔºâ</div>
                <div style="display:flex; align-items:center; gap:10px;">
                    <label style="color:#2C3E50; font-weight:bold;">Ë∫´Èï∑(cm)Ôºö</label>
                    <input type="number" id="userHeight" step="1" value="140" inputmode="numeric" style="width:6rem; padding:8px; border:2px solid #FFD700; border-radius:5px; text-align:center;">
                    <button id="saveHeightBtn" style="padding:8px 15px; background:#FFD700; border:none; border-radius:5px; color:#2C3E50; font-weight:bold; cursor:pointer;">‰øùÂ≠ò</button>
                </div>
                <div style="font-size:0.8em; color:#5A6C7D; margin-top:5px;">Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åô„Çã„Å®„ÄÅÊäï„ÅíÂá∫„ÅóÈ´ò„Åï„ÅåcmÂçò‰Ωç„ÅßÊ≠£Á¢∫„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</div>
            </div>
            
            <!-- ÂãïÁîª„Éó„É¨„Éì„É•„Éº„Ç≥„É≥„ÉÜ„Éä -->
            <div class="video-container" id="videoContainer" style="display: none;">
                <video id="videoPreview" controls style="width: 100%; height: auto; border-radius: 8px;">
                    „Åä‰Ωø„ÅÑ„ÅÆ„Éñ„É©„Ç¶„Ç∂„ÅØÂãïÁîªÂÜçÁîü„Å´ÂØæÂøú„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ
                </video>
            </div>
            
            <!-- ÂãïÁîªÊÉÖÂ†±Ë°®Á§∫ -->
            <div id="videoInfoRow" style="display:none; margin:10px 0; padding:10px; background:#F0F8FF; border-radius:8px; border:1px solid #40E0D0;">
                <div style="font-weight:700; color:#2C3E50; margin-bottom:5px;">üìπ ÂãïÁîªÊÉÖÂ†±</div>
                <div id="videoInfoText" style="font-size:0.9em; color:#5A6C7D;"></div>
            </div>
            
            <!-- Ëß£Êûê„Éú„Çø„É≥ -->
            <button class="analyze-button" id="analyzeBtn" style="display: none;">
                üöÄ Ëß£Êûê„Çπ„Çø„Éº„ÉàÔºÅ
            </button>
            
            <!-- „É°„Éº„Çø„ÉºË°®Á§∫Ôºà„É¢„Éê„Ç§„É´Áî®Ôºâ -->
            <div id="meters" style="display: none;">
                <div class="bar">
                    <div class="fill" id="meterFill"></div>
                </div>
                <div style="text-align: center; font-size: 12px; color: #6B7280;">
                    <span id="meterText">Ê∫ñÂÇô‰∏≠...</span>
                </div>
            </div>
            
            <!-- „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº -->
            <div class="progress-container" id="progressContainer">
                <div class="progress-wave">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    <div class="progress-text" id="progressText">Ëß£Êûê‰∏≠... 0%</div>
                </div>
            </div>
            
            <!-- ÁµêÊûúË°®Á§∫ -->
            <div class="results-container" id="resultsContainer">
                <h3 class="results-title">üéØ Ëß£ÊûêÂÆå‰∫ÜÔºÅ</h3>
                <div class="results-grid">
                    <div class="result-item">
                        <div>
                            <div class="result-label">Êäï„ÅíÂá∫„ÅóËßíÂ∫¶</div>
                            <div class="result-value-unit">
                                <span class="result-value" id="releaseAngle">--</span>
                                <span class="result-unit">¬∞</span>
                            </div>
                        </div>
                        <small class="result-desc">Êäï„Åí„ÇãÁû¨Èñì„ÅÆÊâã„ÅÆËßíÂ∫¶„ÄÇ30-45Â∫¶„ÅåËâØ„ÅÑ„Å®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô</small>
                    </div>
                    <div class="result-item">
                        <div>
                            <div class="result-label">Êäï„ÅíÂá∫„ÅóÈ´ò„Åï</div>
                            <div class="result-value-unit">
                                <span class="result-value" id="releaseHeight">--</span>
                                <span class="result-unit">cm</span>
                            </div>
                        </div>
                        <small class="result-desc">Êäï„Åí„ÇãÁû¨Èñì„ÅÆÊâã„ÅÆÈ´ò„Åï„ÄÇË∫´Èï∑„Å´ÊØî‰æã„Åó„Åæ„Åô</small>
                    </div>
                    <div class="result-item">
                        <div>
                            <div class="result-label">Êäï„Åí„ÇãÂãï‰Ωú„ÅÆÊôÇÈñì</div>
                            <div class="result-value-unit">
                                <span class="result-value" id="plantToRelease">--</span>
                                <span class="result-unit">s</span>
                            </div>
                        </div>
                        <small class="result-desc">Êäï„ÅíÂßã„ÇÅ„Åã„ÇâÊäï„ÅíÁµÇ„Çè„Çä„Åæ„Åß„ÅÆÊôÇÈñì</small>
                    </div>
                    <div class="result-item">
                        <div>
                            <div class="result-label">Êäï„ÅíÂá∫„ÅóÈÄüÂ∫¶</div>
                            <div class="result-value-unit">
                                <span class="result-value" id="releaseSpeed">--</span>
                                <span class="result-unit">m/s</span>
                            </div>
                        </div>
                        <small class="result-desc">Êäï„Åí„ÇãÁû¨Èñì„ÅÆÊâã„ÅÆÈÄü„Åï„ÄÇÈÄü„ÅÑ„Åª„Å©ÈÅ†„Åè„Å´È£õ„Å≥„Åæ„Åô</small>
                    </div>
                    <div class="result-item">
                        <div>
                            <div class="result-label">‰Ωì„ÅÆ„Å≠„Åò„ÇåËßíÂ∫¶</div>
                            <div class="result-value-unit">
                                <span class="result-value" id="shoulderHipSeparation">--</span>
                                <span class="result-unit">¬∞</span>
                            </div>
                        </div>
                        <small class="result-desc">ËÇ©„Å®ËÖ∞„ÅÆ„Å≠„Åò„ÇåÂÖ∑Âêà„ÄÇÈÅ©Â∫¶„Å™„Å≠„Åò„Çå„ÅåÈáçË¶Å„Åß„Åô</small>
                    </div>
                </div>
                
                <!-- ÊäïÊì≤Ë∑ùÈõ¢ÂÖ•Âäõ„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÂâäÈô§ -->
            </div>
        </div>
    </div>
    
    <!-- Èö†„ÅóCanvas -->
    <canvas id="analysisCanvas"></canvas>
    
    <!-- Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´Ôºà„É¢„Éê„Ç§„É´Áî®Ôºâ -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <div class="settings-header">
                <h3>Ë®≠ÂÆö</h3>
                <button class="settings-close" id="settingsClose">&times;</button>
            </div>
            <div class="height-input-row">
                <div style="font-weight:700; color:#2C3E50; margin-bottom:10px;">üìè Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà„Çà„ÇäÊ≠£Á¢∫„Å™Ê∏¨ÂÆö„ÅÆ„Åü„ÇÅÔºâ</div>
                <div style="display:flex; align-items:center; gap:8px; margin-bottom:10px;">
                    <label style="color:#2C3E50; font-weight:bold;">Ë∫´Èï∑(cm)Ôºö</label>
                    <input type="number" id="userHeight" step="1" value="140" inputmode="numeric" style="width:6rem; padding:8px; border:2px solid #FFD700; border-radius:5px; text-align:center;">
                    <button id="saveHeightBtn" style="padding:8px 16px; background:#FF6B35; color:white; border:none; border-radius:5px; cursor:pointer;">‰øùÂ≠ò</button>
                </div>
                <div style="font-size:0.8em; color:#5A6C7D; margin-top:5px;">Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åô„Çã„Å®„ÄÅÊäï„ÅíÂá∫„ÅóÈ´ò„Åï„ÅåcmÂçò‰Ωç„ÅßÊ≠£Á¢∫„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô</div>
            </div>
        </div>
    </div>
    
    <script>
        // Video Analyzer Class
        class VideoAnalyzer {
            constructor() {
                this.video = null;
                this.canvas = null;
                this.ctx = null;
                this.analyzing = false;
                this.optimizedCanvas = null;
                this.optimizedCtx = null;
                this.optimizationRatio = 1.0;
            }
            
            async loadVideo(file) {
                return new Promise((resolve, reject) => {
                    const video = document.getElementById('videoPreview');
                    const url = URL.createObjectURL(file);
                    
                    // ÂãïÁîª„ÅÆË™≠„ÅøËæº„ÅøÁä∂ÊÖã„ÇíËøΩË∑°
                    let metadataLoaded = false;
                    let dataLoaded = false;
                    let canPlay = false;
                    let sizeRetrieved = false;
                    
                    // „Çø„Ç§„É†„Ç¢„Ç¶„ÉàË®≠ÂÆö
                    const timeout = setTimeout(() => {
                        reject(new Error('ÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„Åå„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„ÅüÔºà30ÁßíÔºâ'));
                    }, 30000);
                    
                    // „É°„Çø„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü
                    video.onloadedmetadata = () => {
                        console.log('„É°„Çø„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü:', {
                            width: video.videoWidth,
                            height: video.videoHeight,
                            duration: video.duration
                        });
                        metadataLoaded = true;
                        checkReady();
                    };
                    
                    // ÂãïÁîª„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü
                    video.onloadeddata = () => {
                        console.log('ÂãïÁîª„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü:', {
                            width: video.videoWidth,
                            height: video.videoHeight,
                            readyState: video.readyState
                        });
                        dataLoaded = true;
                        checkReady();
                    };
                    
                    // ÂÜçÁîüÂèØËÉΩÁä∂ÊÖã
                    video.oncanplay = () => {
                        console.log('ÂÜçÁîüÂèØËÉΩÁä∂ÊÖã:', {
                            width: video.videoWidth,
                            height: video.videoHeight,
                            readyState: video.readyState
                        });
                        canPlay = true;
                        checkReady();
                    };
                    
                    // „Çµ„Ç§„Ç∫ÂèñÂæó„ÅÆË©¶Ë°å
                    const tryGetSize = () => {
                        if (video.videoWidth > 0 && video.videoHeight > 0) {
                            sizeRetrieved = true;
                            console.log('„Çµ„Ç§„Ç∫ÂèñÂæóÊàêÂäü:', {
                                width: video.videoWidth,
                                height: video.videoHeight
                            });
                            checkReady();
                        } else {
                            // ‰ª£ÊõøÊñπÊ≥ï„Åß„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
                            const tempCanvas = document.createElement('canvas');
                            const tempCtx = tempCanvas.getContext('2d');
                            
                            try {
                                // ÂãïÁîª„Çí‰∏ÄÊôÇÁöÑ„Å´ÊèèÁîª„Åó„Å¶„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
                                tempCanvas.width = 1;
                                tempCanvas.height = 1;
                                tempCtx.drawImage(video, 0, 0, 1, 1);
                                
                                // ÂãïÁîª„ÅÆËá™ÁÑ∂„Å™„Çµ„Ç§„Ç∫„ÇíÂèñÂæó
                                const naturalWidth = video.naturalWidth || video.videoWidth;
                                const naturalHeight = video.naturalHeight || video.videoHeight;
                                
                                if (naturalWidth > 0 && naturalHeight > 0) {
                                    // ÂãïÁîªË¶ÅÁ¥†„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂº∑Âà∂ÁöÑ„Å´Ë®≠ÂÆö
                                    video.style.width = naturalWidth + 'px';
                                    video.style.height = naturalHeight + 'px';
                                    
                                    // „Éó„É≠„Éë„ÉÜ„Ç£„ÇíÁõ¥Êé•Ë®≠ÂÆö
                                    Object.defineProperty(video, 'videoWidth', {
                                        value: naturalWidth,
                                        writable: false
                                    });
                                    Object.defineProperty(video, 'videoHeight', {
                                        value: naturalHeight,
                                        writable: false
                                    });
                                    
                                    sizeRetrieved = true;
                                    console.log('‰ª£ÊõøÊñπÊ≥ï„Åß„Çµ„Ç§„Ç∫ÂèñÂæóÊàêÂäü:', {
                                        width: naturalWidth,
                                        height: naturalHeight
                                    });
                                    checkReady();
                                } else {
                                    // „Éï„Ç°„Ç§„É´Âêç„Åã„ÇâÊé®Ê∏¨ÔºàMOV„Éï„Ç°„Ç§„É´„ÅÆÂ†¥ÂêàÔºâ
                                    if (file.name.toLowerCase().includes('.mov')) {
                                        console.log('MOV„Éï„Ç°„Ç§„É´Ê§úÂá∫„ÄÅ„Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫„Çí‰ΩøÁî®');
                                        // MOV„Éï„Ç°„Ç§„É´„ÅÆ‰∏ÄËà¨ÁöÑ„Å™„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö
                                        const defaultWidth = 1920;
                                        const defaultHeight = 1080;
                                        
                                        Object.defineProperty(video, 'videoWidth', {
                                            value: defaultWidth,
                                            writable: false
                                        });
                                        Object.defineProperty(video, 'videoHeight', {
                                            value: defaultHeight,
                                            writable: false
                                        });
                                        
                                        sizeRetrieved = true;
                                        console.log('„Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫Ë®≠ÂÆö:', {
                                            width: defaultWidth,
                                            height: defaultHeight
                                        });
                                        checkReady();
                                    }
                                }
                            } catch (e) {
                                console.log('‰ª£Êõø„Çµ„Ç§„Ç∫ÂèñÂæóÂ§±Êïó:', e);
                            }
                        }
                    };
                    
                    // „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞
                    video.onerror = (e) => {
                        console.error('ÂãïÁîªË™≠„ÅøËæº„Åø„Ç®„É©„Éº:', e);
                        clearTimeout(timeout);
                        reject(new Error('ÂãïÁîª„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü'));
                    };
                    
                    // Ê∫ñÂÇôÂÆå‰∫Ü„ÉÅ„Çß„ÉÉ„ÇØ
                    const checkReady = () => {
                        if (metadataLoaded && dataLoaded && canPlay && sizeRetrieved) {
                            clearTimeout(timeout);
                            console.log('ÂãïÁîªÊ∫ñÂÇôÂÆå‰∫Ü - ÊúÄÁµÇÁ¢∫Ë™ç:', {
                                width: video.videoWidth,
                                height: video.videoHeight,
                                duration: video.duration,
                                readyState: video.readyState
                            });
                            
                            // Â∞ë„ÅóÂæÖ„Å£„Å¶„Åã„ÇâË®≠ÂÆö
                            setTimeout(() => {
                                this.setupVideo(video, resolve, reject);
                            }, 100);
                        }
                    };
                    
                    // ÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„ÇíÈñãÂßã
                    video.src = url;
                    video.load(); // ÊòéÁ§∫ÁöÑ„Å´Ë™≠„ÅøËæº„ÅøÈñãÂßã
                    
                    // „Çµ„Ç§„Ç∫ÂèñÂæó„ÇíÂÆöÊúüÁöÑ„Å´Ë©¶Ë°å
                    const sizeCheckInterval = setInterval(() => {
                        if (sizeRetrieved) {
                            clearInterval(sizeCheckInterval);
                            return;
                        }
                        tryGetSize();
                    }, 500);
                    
                    // 10ÁßíÂæå„Å´„Çµ„Ç§„Ç∫ÂèñÂæó„ÇíÂº∑Âà∂ÂÆüË°å
                    setTimeout(() => {
                        if (!sizeRetrieved) {
                            console.log('Âº∑Âà∂„Çµ„Ç§„Ç∫ÂèñÂæóÂÆüË°å');
                            tryGetSize();
                        }
                    }, 10000);
                });
            }
            
            setupVideo(video, resolve, reject) {
                console.log('setupVideoÈñãÂßã:', {
                    videoWidth: video.videoWidth,
                    videoHeight: video.videoHeight,
                    readyState: video.readyState,
                    duration: video.duration
                });
                
                // ÂãïÁîª„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçÁ¢∫Ë™ç
                if (video.videoWidth === 0 || video.videoHeight === 0) {
                    console.error('ÂãïÁîª„Çµ„Ç§„Ç∫„ÅåÁÑ°Âäπ:', {
                        width: video.videoWidth,
                        height: video.videoHeight
                    });
                    
                    // MOV„Éï„Ç°„Ç§„É´„ÅÆÂ†¥Âêà„ÄÅ„Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö
                    if (video.src && video.src.includes('.mov')) {
                        console.log('MOV„Éï„Ç°„Ç§„É´„ÅÆ„Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫„ÇíË®≠ÂÆö');
                        const defaultWidth = 1920;
                        const defaultHeight = 1080;
                        
                        // „Éó„É≠„Éë„ÉÜ„Ç£„ÇíÁõ¥Êé•Ë®≠ÂÆö
                        Object.defineProperty(video, 'videoWidth', {
                            value: defaultWidth,
                            writable: false
                        });
                        Object.defineProperty(video, 'videoHeight', {
                            value: defaultHeight,
                            writable: false
                        });
                        
                        console.log('MOV„Éï„Ç°„Ç§„É´Áî®„Éá„Éï„Ç©„É´„Éà„Çµ„Ç§„Ç∫Ë®≠ÂÆöÂÆå‰∫Ü:', {
                            width: defaultWidth,
                            height: defaultHeight
                        });
                    } else {
                        reject(new Error(`ÂãïÁîª„ÅÆ„Çµ„Ç§„Ç∫„ÅåÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„Åß„Åó„ÅüÔºàwidth: ${video.videoWidth}, height: ${video.videoHeight}Ôºâ`));
                        return;
                    }
                }
                
                // ÂãïÁîª„ÅÆÊ∫ñÂÇôÁä∂ÊÖã„ÇíÁ¢∫Ë™ç
                if (video.readyState < 2) {
                    console.error('ÂãïÁîª„ÅÆÊ∫ñÂÇôÁä∂ÊÖã„Åå‰∏çÂçÅÂàÜ:', {
                        readyState: video.readyState,
                        networkState: video.networkState
                    });
                    reject(new Error('ÂãïÁîª„ÅÆÊ∫ñÂÇô„ÅåÂÆå‰∫Ü„Åó„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ'));
                    return;
                }
                
                this.video = video;
                this.canvas = document.getElementById('analysisCanvas');
                
                // Canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂãïÁîª„ÅÆ„Çµ„Ç§„Ç∫„Å´Ë®≠ÂÆö
                this.canvas.width = video.videoWidth;
                this.canvas.height = video.videoHeight;
                
                // Canvas„ÅÆ„Ç≥„É≥„ÉÜ„Ç≠„Çπ„Éà„ÇíÂèñÂæó
                this.ctx = this.canvas.getContext('2d');
                
                // ÊúÄÈÅ©ÂåñÁî®„ÅÆCanvas„Çí‰ΩúÊàê
                this.createOptimizedCanvas();
                
                console.log('ÂãïÁîªË®≠ÂÆöÂÆå‰∫Ü:', {
                    width: video.videoWidth,
                    height: video.videoHeight,
                    duration: video.duration,
                    canvasWidth: this.canvas.width,
                    canvasHeight: this.canvas.height,
                    optimizedWidth: this.optimizedCanvas.width,
                    optimizedHeight: this.optimizedCanvas.height,
                    optimizationRatio: this.optimizationRatio
                });
                
                resolve();
            }
            
            createOptimizedCanvas() {
                const originalWidth = this.video.videoWidth;
                const originalHeight = this.video.videoHeight;
                
                // Ëß£Êûê„Å´ÊúÄÈÅ©„Å™„Çµ„Ç§„Ç∫„ÇíË®àÁÆó
                let targetWidth, targetHeight;
                
                if (originalWidth > 1920 || originalHeight > 1080) {
                    // 4K‰ª•‰∏ä„ÅÆÂãïÁîª„ÅØ1080p„Å´Á∏ÆÂ∞è
                    if (originalWidth > originalHeight) {
                        targetWidth = 1920;
                        targetHeight = Math.round((1920 * originalHeight) / originalWidth);
                    } else {
                        targetHeight = 1080;
                        targetWidth = Math.round((1080 * originalWidth) / originalHeight);
                    }
                } else if (originalWidth > 1280 || originalHeight > 720) {
                    // „Éï„É´HD‰ª•‰∏ä„ÅÆÂãïÁîª„ÅØ720p„Å´Á∏ÆÂ∞è
                    if (originalWidth > originalHeight) {
                        targetWidth = 1280;
                        targetHeight = Math.round((1280 * originalHeight) / originalWidth);
                    } else {
                        targetHeight = 720;
                        targetWidth = Math.round((720 * originalWidth) / originalHeight);
                    }
                } else {
                    // „Åù„Çå‰ª•‰∏ã„ÅÆÂãïÁîª„ÅØ„Åù„ÅÆ„Åæ„Åæ
                    targetWidth = originalWidth;
                    targetHeight = originalHeight;
                }
                
                // ÊúÄÈÅ©ÂåñÊØîÁéá„ÇíË®àÁÆó
                this.optimizationRatio = targetWidth / originalWidth;
                
                // ÊúÄÈÅ©ÂåñÁî®Canvas„Çí‰ΩúÊàê
                this.optimizedCanvas = document.createElement('canvas');
                this.optimizedCanvas.width = targetWidth;
                this.optimizedCanvas.height = targetHeight;
                this.optimizedCtx = this.optimizedCanvas.getContext('2d');
                
                console.log('ÂãïÁîªÊúÄÈÅ©ÂåñË®≠ÂÆö:', {
                    original: `${originalWidth}x${originalHeight}`,
                    optimized: `${targetWidth}x${targetHeight}`,
                    ratio: this.optimizationRatio.toFixed(3),
                    reduction: `${((1 - this.optimizationRatio) * 100).toFixed(1)}%`
                });
            }
            
            async analyze(progressCallback) {
                if (!this.video || this.analyzing) return null;
                
                // ÂãïÁîª„Å®Canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçÁ¢∫Ë™ç
                if (this.video.videoWidth === 0 || this.video.videoHeight === 0) {
                    throw new Error('ÂãïÁîª„ÅÆ„Çµ„Ç§„Ç∫„ÅåÂèñÂæó„Åß„Åç„Åæ„Åõ„Çì„ÄÇÂãïÁîª„ÅÆË™≠„ÅøËæº„Åø„ÇíÂÆå‰∫Ü„Åó„Å¶„Åã„ÇâÂÜçÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ');
                }
                
                if (this.canvas.width === 0 || this.canvas.height === 0) {
                    // Canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçË®≠ÂÆö
                    this.canvas.width = this.video.videoWidth;
                    this.canvas.height = this.video.videoHeight;
                    console.log('Canvas„Çµ„Ç§„Ç∫„ÇíÂÜçË®≠ÂÆö:', {
                        width: this.canvas.width,
                        height: this.canvas.height
                    });
                }
                
                console.log('Ëß£ÊûêÈñãÂßã - ÂãïÁîªÊÉÖÂ†±:', {
                    duration: this.video.duration,
                    width: this.video.videoWidth,
                    height: this.video.videoHeight,
                    canvasWidth: this.canvas.width,
                    canvasHeight: this.canvas.height,
                    optimizedWidth: this.optimizedCanvas.width,
                    optimizedHeight: this.optimizedCanvas.height,
                    optimizationRatio: this.optimizationRatio
                });
                
                this.analyzing = true;
                const fps = 30;
                const duration = Math.min(this.video.duration, 10); // ÊúÄÂ§ß10Áßí„Å´Êã°Âºµ
                const totalFrames = duration * fps;
                const frameSkip = 2; // „Éï„É¨„Éº„É†„Çπ„Ç≠„ÉÉ„Éó„ÇíÊ∏õ„Çâ„Åó„Å¶Á≤æÂ∫¶Âêë‰∏ä
                
                const motionData = {
                    positions: [],
                    heights: [],
                    timestamps: [],
                    motionAreas: []
                };
                
                this.video.currentTime = 0;
                let backgroundFrame = null;
                let frameCount = 0;
                
                try {
                    for (let i = 0; i < totalFrames; i += frameSkip) {
                        if (!this.analyzing) break;
                        
                        this.video.currentTime = i / fps;
                        await this.waitForFrame();
                        
                        // ÂãïÁîª„ÇíCanvas„Å´ÊèèÁîª
                        this.ctx.drawImage(this.video, 0, 0);
                        
                        // Canvas„ÅÆ„Çµ„Ç§„Ç∫„ÇíÂÜçÁ¢∫Ë™ç
                        if (this.canvas.width === 0 || this.canvas.height === 0) {
                            throw new Error('Canvas„ÅÆ„Çµ„Ç§„Ç∫„ÅåÁÑ°Âäπ„Åß„Åô');
                        }
                        
                        // ÊúÄÈÅ©Âåñ„Åï„Çå„ÅüCanvas„Å´„É™„Çµ„Ç§„Ç∫„Åó„Å¶ÊèèÁîª
                        this.optimizedCtx.drawImage(
                            this.canvas, 
                            0, 0, this.canvas.width, this.canvas.height,
                            0, 0, this.optimizedCanvas.width, this.optimizedCanvas.height
                        );
                        
                        // Ëß£Êûê„É´„Éº„ÉóÂÅ¥„ÅÆ0„Çµ„Ç§„Ç∫‰øùÈô∫ÔºàgetImageDataÂâç„Å´ÂøÖ„Åö„ÉÅ„Çß„ÉÉ„ÇØÔºâ
                        if (!this.optimizedCanvas.width || !this.optimizedCanvas.height) {
                            console.warn('skip frame: canvas size is 0'); 
                            continue; // „Åì„ÅÆ„Éï„É¨„Éº„É†„ÇíÈ£õ„Å∞„Åô
                        }
                        
                        // ÊúÄÈÅ©Âåñ„Åï„Çå„ÅüCanvas„Åã„ÇâÁîªÂÉè„Éá„Éº„Çø„ÇíÂèñÂæó
                        const imageData = this.optimizedCtx.getImageData(0, 0, this.optimizedCanvas.width, this.optimizedCanvas.height);
                        
                        if (!backgroundFrame) {
                            backgroundFrame = imageData;
                            console.log('ËÉåÊôØ„Éï„É¨„Éº„É†Ë®≠ÂÆöÂÆå‰∫ÜÔºàÊúÄÈÅ©ÂåñÊ∏à„ÅøÔºâ');
                        } else {
                            const motion = this.detectMotion(imageData, backgroundFrame);
                            if (motion) {
                                // ÊúÄÈÅ©Âåñ„Åï„Çå„ÅüÂ∫ßÊ®ô„ÇíÂÖÉ„ÅÆÂ∫ßÊ®ôÁ≥ª„Å´Â§âÊèõ
                                const originalPosition = {
                                    x: motion.center.x / this.optimizationRatio,
                                    y: motion.center.y / this.optimizationRatio
                                };
                                const originalTopPoint = {
                                    x: motion.topPoint.x / this.optimizationRatio,
                                    y: motion.topPoint.y / this.optimizationRatio
                                };
                                
                                motionData.positions.push(originalPosition);
                                motionData.heights.push(originalTopPoint);
                                motionData.timestamps.push(i / fps);
                                motionData.motionAreas.push(motion.area);
                                frameCount++;
                            }
                        }
                        
                        if (progressCallback) {
                            const progress = Math.round((i / totalFrames) * 100);
                            progressCallback(progress);
                        }
                    }
                    
                    console.log('Ëß£ÊûêÂÆå‰∫Ü - Ê§úÂá∫„Éï„É¨„Éº„É†Êï∞:', frameCount);
                    console.log('Âãï„Åç„Éá„Éº„Çø:', motionData);
                    
                } catch (error) {
                    console.error('Ëß£Êûê‰∏≠„ÅÆ„Ç®„É©„Éº:', error);
                    throw error;
                } finally {
                    this.analyzing = false;
                }
                
                return this.calculateMetrics(motionData);
            }
            
            waitForFrame() {
                return new Promise(resolve => {
                    requestAnimationFrame(() => {
                        setTimeout(resolve, 50);
                    });
                });
            }
            
            detectMotion(currentFrame, backgroundFrame) {
                const width = this.optimizedCanvas.width;
                const height = this.optimizedCanvas.height;
                const current = currentFrame.data;
                const background = backgroundFrame.data;
                
                let minX = width, maxX = 0;
                let minY = height, maxY = 0;
                let pixelCount = 0;
                let totalDiff = 0;
                
                // ÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Çµ„Ç§„Ç∫„Å´Âêà„Çè„Åõ„Å¶„Çπ„Ç≠„É£„É≥ÈñìÈöî„ÇíË™øÊï¥
                const scanInterval = width > 1280 ? 3 : 2;
                
                // „Çà„ÇäÁ¥∞„Åã„ÅÑ„Çπ„Ç≠„É£„É≥ÔºàÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶Ë™øÊï¥Ôºâ
                for (let y = 0; y < height; y += scanInterval) {
                    for (let x = 0; x < width; x += scanInterval) {
                        const idx = (y * width + x) * 4;
                        
                        // RGB„ÅÆÂ∑ÆÂàÜ„ÇíË®àÁÆó
                        const diffR = Math.abs(current[idx] - background[idx]);
                        const diffG = Math.abs(current[idx + 1] - background[idx + 1]);
                        const diffB = Math.abs(current[idx + 2] - background[idx + 2]);
                        
                        // ÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶ÈñæÂÄ§„ÇíË™øÊï¥
                        const threshold = width > 1280 ? 40 : 50;
                        const diff = diffR + diffG + diffB;
                        
                        if (diff > threshold) {
                            minX = Math.min(minX, x);
                            maxX = Math.max(maxX, x);
                            minY = Math.min(minY, y);
                            maxY = Math.max(maxY, y);
                            pixelCount++;
                            totalDiff += diff;
                        }
                    }
                }
                
                // Âãï„Åç„ÅÆÂìÅË≥™„ÉÅ„Çß„ÉÉ„ÇØÔºàÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶Ë™øÊï¥Ôºâ
                const area = (maxX - minX) * (maxY - minY);
                const avgDiff = totalDiff / pixelCount;
                
                // ÊúÄÈÅ©Âåñ„Åï„Çå„Åü„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶Êù°‰ª∂„ÇíË™øÊï¥
                const minArea = width > 1280 ? 800 : 1000;
                const minPixels = width > 1280 ? 80 : 100;
                const minDiff = width > 1280 ? 25 : 30;
                
                console.log('Âãï„ÅçÊ§úÂá∫ÔºàÊúÄÈÅ©ÂåñÊ∏à„ÅøÔºâ:', {
                    area: area,
                    pixelCount: pixelCount,
                    avgDiff: Math.round(avgDiff),
                    bounds: { minX, maxX, minY, maxY },
                    scanInterval: scanInterval,
                    threshold: width > 1280 ? 40 : 50
                });
                
                // „Çà„ÇäÂé≥ÂØÜ„Å™Êù°‰ª∂
                if (area < minArea || pixelCount < minPixels || avgDiff < minDiff) {
                    return null;
                }
                
                return {
                    center: { x: (minX + maxX) / 2, y: (minY + maxY) / 2 },
                    topPoint: { x: (minX + maxX) / 2, y: minY },
                    area: area,
                    quality: avgDiff
                };
            }
            
            calculateMetrics(motionData) {
                console.log('„É°„Éà„É™„ÇØ„ÇπË®àÁÆóÈñãÂßã:', motionData);
                
                if (motionData.positions.length < 5) {
                    console.error('Âãï„Åç„Éá„Éº„Çø„Åå‰∏çË∂≥:', motionData.positions.length);
                    return null;
                }
                
                const positions = motionData.positions;
                const heights = motionData.heights;
                const areas = motionData.motionAreas;
                
                // ÊäïÊì≤Âãï‰Ωú„ÅÆÁâπÂæ¥„ÇíÂàÜÊûê
                const maxAreaIndex = areas.indexOf(Math.max(...areas));
                const minHeightIndex = heights.indexOf(Math.min(...heights, h => h.y));
                
                console.log('ÊäïÊì≤Âãï‰ΩúÂàÜÊûê:', {
                    maxAreaIndex: maxAreaIndex,
                    minHeightIndex: minHeightIndex,
                    maxArea: areas[maxAreaIndex],
                    minHeight: heights[minHeightIndex]
                });
                
                // „Çà„ÇäÂÆüÁî®ÁöÑ„Å™Ë®àÁÆó
                const releaseIndex = Math.min(maxAreaIndex + 2, positions.length - 1);
                const plantIndex = Math.max(0, maxAreaIndex - 2);
                
                // „É™„É™„Éº„ÇπËßíÂ∫¶„ÅÆË®àÁÆóÔºàÊîπÂñÑÁâàÔºâ
                const dx = heights[releaseIndex].x - positions[releaseIndex].x;
                const dy = heights[releaseIndex].y - positions[releaseIndex].y;
                const angle = Math.atan2(-dy, dx) * 180 / Math.PI;
                
                // „É™„É™„Éº„ÇπÈ´ò„Åï„ÅÆË®àÁÆóÔºàÁîªÈù¢„ÅÆ‰∏ã„Åã„Çâ„ÅÆÁõ∏ÂØæ‰ΩçÁΩÆÔºâ
                const releaseHeight = (this.canvas.height - heights[releaseIndex].y) / this.canvas.height * 100;
                
                // Âãï‰ΩúÊôÇÈñì„ÅÆË®àÁÆó
                const motionTime = motionData.timestamps[releaseIndex] - motionData.timestamps[plantIndex];
                
                // ÊäïÊì≤„ÅÆÂìÅË≥™Ë©ï‰æ°
                const quality = this.evaluateThrowQuality(motionData);
                
                const result = {
                    releaseAngle: Math.abs(Math.round(angle)),
                    releaseHeight: Math.round(releaseHeight),
                    motionTime: Math.round(motionTime * 100) / 100,
                    quality: quality,
                    frameCount: positions.length
                };
                
                console.log('Ë®àÁÆóÁµêÊûú:', result);
                return result;
            }
            
            evaluateThrowQuality(motionData) {
                const areas = motionData.motionAreas;
                const avgArea = areas.reduce((a, b) => a + b, 0) / areas.length;
                const maxArea = Math.max(...areas);
                
                // Âãï„Åç„ÅÆ‰∏ÄË≤´ÊÄß„ÇíË©ï‰æ°
                let consistency = 0;
                for (let i = 1; i < areas.length; i++) {
                    const change = Math.abs(areas[i] - areas[i-1]) / avgArea;
                    if (change < 0.3) consistency++;
                }
                
                const consistencyScore = (consistency / (areas.length - 1)) * 100;
                
                if (consistencyScore > 80 && maxArea > 5000) return 'Excellent';
                if (consistencyScore > 60 && maxArea > 3000) return 'Good';
                if (consistencyScore > 40 && maxArea > 1000) return 'Fair';
                return 'Poor';
            }
        }
        
        // Initialize
        const analyzer = new VideoAnalyzer();
        
        // Event Listeners
        const uploadZone = document.getElementById('uploadZone');
        const videoFile = document.getElementById('videoFile');
        const videoContainer = document.getElementById('videoContainer');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const progressContainer = document.getElementById('progressContainer');
        const resultsContainer = document.getElementById('resultsContainer');
        
        // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÅÆË®≠ÂÆö„ÇíÁ¢∫ÂÆü„Å´„Åô„Çã
        function setupEventListeners() {
            console.log('„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆöÈñãÂßã');
            
            // Upload handling
            if (uploadZone) {
                uploadZone.addEventListener('click', () => videoFile.click());
                
                uploadZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadZone.classList.add('dragover');
                });
                
                uploadZone.addEventListener('dragleave', () => {
                    uploadZone.classList.remove('dragover');
                });
                
                uploadZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadZone.classList.remove('dragover');
                    const files = e.dataTransfer.files;
                    if (files.length > 0) handleVideoSelect(files[0]);
                });
            }
            
            if (videoFile) {
                videoFile.addEventListener('change', (e) => {
                    if (e.target.files.length > 0) {
                        handleVideoSelect(e.target.files[0]);
                    }
                });
            }
            
            // Analysis button event listener
            if (analyzeBtn) {
                console.log('Ëß£Êûê„Éú„Çø„É≥„ÅÆ„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö');
                analyzeBtn.addEventListener('click', async () => {
                    console.log('=== Ëß£ÊûêÈñãÂßã ===');
                    
                    try {
                        // Ë∫´Èï∑„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                        if (!userHeight || userHeight < 100) {
                            alert('ÂÖà„Å´Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ');
                            return;
                        }
                        
                        // ÂãïÁîª„Éï„Ç°„Ç§„É´„ÅåÈÅ∏Êäû„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                        const videoFile = document.getElementById('videoFile');
                        if (!videoFile.files || videoFile.files.length === 0) {
                            alert('ÂÖà„Å´ÂãïÁîª„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ');
                            return;
                        }
                        
                        const file = videoFile.files[0];
                        console.log('Ëß£ÊûêÂØæË±°„Éï„Ç°„Ç§„É´:', {
                            name: file.name,
                            size: file.size,
                            type: file.type
                        });
                        
                        // Ëß£Êûê„Éú„Çø„É≥„ÇíÁÑ°ÂäπÂåñ
                        analyzeBtn.disabled = true;
                        analyzeBtn.textContent = 'Ëß£Êûê‰∏≠...';
                        
                        // „Éó„É≠„Ç∞„É¨„ÇπË°®Á§∫
                        progressContainer.style.display = 'block';
                        resultsContainer.style.display = 'none';
                        
                        console.log('Ëß£ÊûêÂá¶ÁêÜÈñãÂßã...');
                        
                        // Á∞°Âçò„Å™Ëß£ÊûêÂá¶ÁêÜÔºà„ÉÜ„Çπ„ÉàÁî®Ôºâ
                        console.log('simpleAnalysisÈñ¢Êï∞„ÇíÂëº„Å≥Âá∫„Åó...');
                        const result = await simpleAnalysis(file);
                        console.log('simpleAnalysisÁµêÊûú:', result);
                        
                        if (result) {
                            // ÁµêÊûúË°®Á§∫
                            document.getElementById('releaseAngle').textContent = result.releaseAngleDeg;
                            document.getElementById('releaseHeight').textContent = result.releaseHeightCm;
                            document.getElementById('plantToRelease').textContent = result.plantToRelease;
                            document.getElementById('releaseSpeed').textContent = result.releaseSpeedMS;
                            document.getElementById('shoulderHipSeparation').textContent = result.sepDeg;
                            
                            // ÁµêÊûú„Çí„Ç∞„É≠„Éº„Éê„É´Â§âÊï∞„Å´‰øùÂ≠ò
                            window.lastResult = result;
                            
                            progressContainer.style.display = 'none';
                            resultsContainer.style.display = 'block';
                            
                            console.log('Ëß£ÊûêÂÆå‰∫Ü:', result);
                            alert('ÊäïÊì≤Âãï‰Ωú„ÅÆËß£Êûê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„ÅüÔºÅüéØ\n\nÊäï„ÅíÊñπ„ÅÆ„Éù„Ç§„É≥„Éà„ÅåÂàÜ„Åã„Çä„Åæ„Åó„ÅüÔºÅ');
                        } else {
                            alert('Ëß£Êûê„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇÂãïÁîª„ÅÆÂÜÖÂÆπ„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                        }
                        
                    } catch (error) {
                        console.error('Ëß£Êûê„Ç®„É©„Éº:', error);
                        alert('Ëß£Êûê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + error.message);
                    } finally {
                        // Ëß£Êûê„Éú„Çø„É≥„ÇíÂæ©Ê¥ª
                        analyzeBtn.disabled = false;
                        analyzeBtn.textContent = 'üöÄ Ëß£Êûê„Çπ„Çø„Éº„ÉàÔºÅ';
                        console.log('Ëß£ÊûêÂá¶ÁêÜÁµÇ‰∫Ü');
                    }
                });
            } else {
                console.error('Ëß£Êûê„Éú„Çø„É≥„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
            }
            
            console.log('„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆöÂÆå‰∫Ü');
        }
        
        // DOMË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÊôÇ„Å´„Ç§„Éô„É≥„Éà„É™„Çπ„Éä„Éº„ÇíË®≠ÂÆö
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', setupEventListeners);
        } else {
            setupEventListeners();
        }
        
        // ÂàùÊúüË°®Á§∫ÊôÇ„Å´ÁõÆÊ®ôÂÄ§„ÇíË®≠ÂÆö
        function initializeGoals() {
            const h = userHeight;
            const tg = targetsFor(h);
            
            // ÁõÆÊ®ôË°®Ë®ò„ÇíÂàùÊúüË®≠ÂÆö
            setGoal('goalAngle',  `ÁõÆÊ®ô: ${tg.angle[0]}‚Äì${tg.angle[1]}¬∞`);
            setGoal('goalHeight', `ÁõÆÊ®ô: ${tg.height[0].toFixed(0)}‚Äì${tg.height[1].toFixed(0)} cm`);
            setGoal('goalSpeed',  `ÁõÆÊ®ô: ${tg.speed[0].toFixed(1)}‚Äì${tg.speed[1].toFixed(1)} m/s`);
            setGoal('goalSep',    `ÁõÆÊ®ô: ${tg.sep[0]}‚Äì${tg.sep[1]}¬∞`);
        }
        
        // ÂàùÊúüÂåñÂÆå‰∫ÜÂæå„Å´ÁõÆÊ®ôÂÄ§„ÇíË®≠ÂÆö
        setTimeout(initializeGoals, 100);
        
        // ========== „Ç∑„É≥„Éó„É´„ÅßÁ¢∫ÂÆü„Å™ÂãïÁîªÂá¶ÁêÜ ==========
        async function handleVideoSelect(file) {
            console.log('=== ÂãïÁîªÂá¶ÁêÜÈñãÂßã ===');
            console.log('„Éï„Ç°„Ç§„É´ÊÉÖÂ†±:', {
                name: file.name,
                size: file.size,
                type: file.type,
                lastModified: file.lastModified
            });
            
            try {
                // „Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÉÅ„Çß„ÉÉ„ÇØ
                if (file.size > 100 * 1024 * 1024) {
                    alert('„Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅåÂ§ß„Åç„Åô„Åé„Åæ„Åô üö´\n\nÁèæÂú®„ÅÆ„Éï„Ç°„Ç§„É´: ' + (file.size / (1024 * 1024)).toFixed(1) + 'MB\nÊé®Â•®„Çµ„Ç§„Ç∫: 100MB‰ª•‰∏ã');
                    return;
                }
                
                // ÂãïÁîªÂΩ¢Âºè„ÉÅ„Çß„ÉÉ„ÇØ
                if (!checkVideoCompatibility(file)) {
                    alert('ÂØæÂøú„Åó„Å¶„ÅÑ„Å™„ÅÑÂãïÁîªÂΩ¢Âºè„Åß„Åô„ÄÇ\n\nÂØæÂøúÂΩ¢Âºè: MP4, WebM, AVI, MOV');
                    return;
                }
                
                // Ë∫´Èï∑„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                if (!userHeight || userHeight < 100) {
                    alert('ÂÖà„Å´Ë∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºÅ\n\nË∫´Èï∑„ÇíÂÖ•Âäõ„Åó„Å¶„Åã„ÇâÂãïÁîª„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    return;
                }
                
                // ÂãïÁîªÊÉÖÂ†±„ÇíË°®Á§∫
                const videoInfoRow = document.getElementById('videoInfoRow');
                const videoInfoText = document.getElementById('videoInfoText');
                if (videoInfoRow && videoInfoText) {
                    const format = window.VideoHelper.getVideoFormat(file);
                    const size = window.VideoHelper.formatFileSize(file.size);
                    
                    // „Éï„Ç°„Ç§„É´Âêç„Åã„ÇâÂΩ¢Âºè„ÇíÊé®Ê∏¨„Åó„Å¶„Éá„Éï„Ç©„É´„ÉàËß£ÂÉèÂ∫¶„ÇíË®≠ÂÆö
                    const fileName = file.name.toLowerCase();
                    let width = 1280;
                    let height = 720;
                    
                    if (fileName.includes('.mov')) {
                        width = 1920;
                        height = 1080;
                    } else if (fileName.includes('.mp4')) {
                        width = 1280;
                        height = 720;
                    }
                    
                    videoInfoText.innerHTML = `
                        <strong>„Éï„Ç°„Ç§„É´Âêç:</strong> ${file.name}<br>
                        <strong>ÂΩ¢Âºè:</strong> ${format.toUpperCase()}<br>
                        <strong>„Çµ„Ç§„Ç∫:</strong> ${size}<br>
                        <strong>Ëß£ÂÉèÂ∫¶:</strong> ${width} √ó ${height}<br>
                        <strong>Ë∫´Èï∑:</strong> ${userHeight}cm
                    `;
                    videoInfoRow.style.display = 'block';
                }
                
                // „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Ç®„É™„Ç¢„ÇíÈùûË°®Á§∫
                uploadZone.style.display = 'none';
                
                // Ëß£Êûê„Éú„Çø„É≥„ÇíË°®Á§∫
                analyzeBtn.style.display = 'block';
                
                console.log('ÂãïÁîªÂá¶ÁêÜÂÆå‰∫Ü„ÄÅËß£ÊûêÊ∫ñÂÇôÂÆå‰∫Ü');
                
            } catch (error) {
                console.error('handleVideoSelect „Ç®„É©„Éº:', error);
                alert('ÂãïÁîªÂá¶ÁêÜ‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + error.message);
            }
        }
        
        // ÊúÄÈÅ©ÂåñÊÉÖÂ†±„ÇíÂèñÂæó
        function getOptimizationInfo() {
            const video = document.getElementById('videoPreview');
            const originalWidth = video.videoWidth;
            const originalHeight = video.videoHeight;
            
            let targetWidth, targetHeight, optimizationLevel, specialNote = '';
            
            if (originalWidth > 1920 || originalHeight > 1080) {
                if (originalWidth > originalHeight) {
                    targetWidth = 1920;
                    targetHeight = Math.round((1920 * originalHeight) / originalWidth);
                } else {
                    targetHeight = 1080;
                    targetWidth = Math.round((1080 * originalWidth) / originalHeight);
                }
                optimizationLevel = '4K‚Üí1080p';
            } else if (originalWidth > 1280 || originalHeight > 720) {
                if (originalWidth > originalHeight) {
                    targetWidth = 1280;
                    targetHeight = Math.round((1280 * originalHeight) / originalWidth);
                } else {
                    targetHeight = 720;
                    targetWidth = Math.round((720 * originalWidth) / originalHeight);
                }
                optimizationLevel = '„Éï„É´HD‚Üí720p';
            } else {
                targetWidth = originalWidth;
                targetHeight = originalHeight;
                optimizationLevel = 'ÊúÄÈÅ©Âåñ„Å™„Åó';
            }
            
            // MOV„Éï„Ç°„Ç§„É´„ÅÆÂ†¥Âêà„ÅÆÁâπÂà•Ë™¨Êòé
            if (video.src && video.src.includes('.mov')) {
                specialNote = 'üì± MOV„Éï„Ç°„Ç§„É´ÂØæÂøúÊ∏à„Åø';
                if (optimizationLevel === 'ÊúÄÈÅ©Âåñ„Å™„Åó') {
                    optimizationLevel = 'MOV‚Üí1080p';
                    targetWidth = 1920;
                    targetHeight = 1080;
                }
            }
            
            const reduction = ((1 - (targetWidth / originalWidth)) * 100).toFixed(1);
            
            return {
                original: `${originalWidth}x${originalHeight}`,
                optimized: `${targetWidth}x${targetHeight}`,
                level: optimizationLevel,
                reduction: reduction,
                specialNote: specialNote
            };
        }
        
        // ÊúÄÈÅ©ÂåñÊÉÖÂ†±„ÇíË°®Á§∫
        function displayOptimizationInfo(info) {
            const videoContainer = document.getElementById('videoContainer');
            
            // ÊúÄÈÅ©ÂåñÊÉÖÂ†±„ÅÆË°®Á§∫„ÇíËøΩÂä†
            const optimizationDiv = document.createElement('div');
            optimizationDiv.className = 'optimization-info';
            optimizationDiv.innerHTML = `
                <div class="optimization-header">
                    <span class="optimization-icon">‚ö°</span>
                    <span class="optimization-title">ÂãïÁîªÊúÄÈÅ©ÂåñÂÆå‰∫Ü</span>
                </div>
                <div class="optimization-details">
                    <div class="optimization-item">
                        <span class="label">ÂÖÉ„ÅÆ„Çµ„Ç§„Ç∫:</span>
                        <span class="value">${info.original}</span>
                    </div>
                    <div class="optimization-item">
                        <span class="label">ÊúÄÈÅ©ÂåñÂæå:</span>
                        <span class="value">${info.optimized}</span>
                    </div>
                    <div class="optimization-item">
                        <span class="label">ÊúÄÈÅ©Âåñ„É¨„Éô„É´:</span>
                        <span class="value">${info.level}</span>
                    </div>
                    <div class="optimization-item">
                        <span class="label">ÂÆπÈáèÂâäÊ∏õ:</span>
                        <span class="value">${info.reduction}%</span>
                    </div>
                    ${info.specialNote ? `
                    <div class="optimization-item special-note">
                        <span class="label">ÁâπÂà•ÂØæÂøú:</span>
                        <span class="value">${info.specialNote}</span>
                    </div>
                    ` : ''}
                </div>
            `;
            
            // ÂãïÁîª„ÅÆÂâç„Å´ÊåøÂÖ•
            videoContainer.insertBefore(optimizationDiv, videoContainer.firstChild);
        }
        
        // Fun interactions
        function toggleTheme() {
            const sun = document.querySelector('.sun');
            sun.style.transform = 'scale(1.5) rotate(360deg)';
            setTimeout(() => {
                sun.style.transform = 'scale(1) rotate(0deg)';
            }, 300);
        }
        
        // Beach balls and javelin items click effect
        document.querySelectorAll('.beach-ball, .javelin-item').forEach(item => {
            item.addEventListener('click', function() {
                this.style.animation = 'none';
                setTimeout(() => {
                    this.style.animation = '';
                }, 10);
                
                // „Ç∏„É£„Éô„É™„ÉÉ„ÇØ„Ç¢„Ç§„ÉÜ„É†„ÇØ„É™„ÉÉ„ÇØÊôÇ„ÅÆ„Ç®„Éï„Çß„ÇØ„Éà
                if (this.classList.contains('javelin-item')) {
                    const originalTransform = window.getComputedStyle(this).transform;
                    this.style.transform = 'scale(1.5) rotate(360deg)';
                    setTimeout(() => {
                        this.style.transform = originalTransform;
                    }, 500);
                }
            });
        });
        
        // ========== „É¶„Éº„ÉÜ„Ç£„É™„ÉÜ„Ç£ ==========
        function sleep(ms) { 
            return new Promise(r => setTimeout(r, ms)); 
        }
        
        // ========== Âü∫Êú¨ÁöÑ„Å™ÂãïÁîªÂá¶ÁêÜ ==========
        function checkVideoCompatibility(file) {
            const ext = (file.name.split('.').pop() || '').toLowerCase();
            const type = file.type || '';
            
            console.log('ÂãïÁîª‰∫íÊèõÊÄß„ÉÅ„Çß„ÉÉ„ÇØ:', { ext, type, name: file.name });
            
            // Âü∫Êú¨ÁöÑ„Å™ÂØæÂøúÂΩ¢Âºè
            if (ext === 'mp4' || ext === 'webm' || ext === 'avi' || ext === 'mov') {
                return true;
            }
            
            return false;
        }
        
        // Âü∫Êú¨ÁöÑ„Å™ÂãïÁîªÁä∂ÊÖã„ÉÅ„Çß„ÉÉ„ÇØ
        function isVideoReady(video) {
            return video && 
                   video.readyState >= 2 && 
                   video.videoWidth > 0 && 
                   video.videoHeight > 0;
        }
        
        // Âü∫Êú¨ÁöÑ„Å™ÂãïÁîªÂá¶ÁêÜÈñ¢Êï∞
        function createVideoElement() {
            const video = document.createElement('video');
            video.preload = 'metadata';
            video.muted = true;
            video.playsInline = true;
            video.controls = true;
            return video;
        }
        
        // Ë∫´Èï∑‰øùÂ≠òÊ©üËÉΩ
        let userHeight = 140; // „Éá„Éï„Ç©„É´„ÉàË∫´Èï∑„Çí140cm„Å´Â§âÊõ¥
        
        // Ë∫´Èï∑‰øùÂ≠òÊ©üËÉΩ„ÅÆÂàùÊúüÂåñ
        function initializeHeightInput() {
            const saveHeightBtn = document.getElementById('saveHeightBtn');
            const userHeightInput = document.getElementById('userHeight');
            
            if (saveHeightBtn && userHeightInput) {
                saveHeightBtn.addEventListener('click', function() {
                    const height = parseInt(userHeightInput.value);
                    if (height >= 100 && height <= 250) {
                        userHeight = height;
                        alert(`Ë∫´Èï∑„Çí ${height}cm „Å´Ë®≠ÂÆö„Åó„Åæ„Åó„ÅüÔºÅ`);
                        console.log('Ë∫´Èï∑Ë®≠ÂÆö:', userHeight + 'cm');
                        
                        // ÂãïÁîªÊÉÖÂ†±„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØË∫´Èï∑„ÇíÊõ¥Êñ∞
                        const videoInfoRow = document.getElementById('videoInfoRow');
                        if (videoInfoRow && videoInfoRow.style.display !== 'none') {
                            const videoInfoText = document.getElementById('videoInfoText');
                            if (videoInfoText) {
                                // Êó¢Â≠ò„ÅÆÂãïÁîªÊÉÖÂ†±„Åã„ÇâË∫´Èï∑‰ª•Â§ñ„ÅÆÈÉ®ÂàÜ„ÇíÂèñÂæó
                                const currentInfo = videoInfoText.innerHTML;
                                const lines = currentInfo.split('<br>');
                                const newLines = lines.map(line => {
                                    if (line.includes('Ë∫´Èï∑:')) {
                                        return `<strong>Ë∫´Èï∑:</strong> ${userHeight}cm`;
                                    }
                                    return line;
                                });
                                videoInfoText.innerHTML = newLines.join('<br>');
                            }
                        }
                    } else {
                        alert('Ë∫´Èï∑„ÅØ100cm„Äú250cm„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
                    }
                });
                
                // „Éá„Éï„Ç©„É´„ÉàÂÄ§„ÇíË®≠ÂÆö
                userHeightInput.value = userHeight;
                
                // Ë∫´Èï∑ÂÖ•ÂäõÊôÇ„ÅÆÂç≥ÊôÇÊõ¥Êñ∞
                userHeightInput.addEventListener('input', function() {
                    const height = parseInt(this.value);
                    if (height >= 100 && height <= 250) {
                        userHeight = height;
                        
                        // ÂãïÁîªÊÉÖÂ†±„ÅåË°®Á§∫„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØË∫´Èï∑„ÇíÂç≥Â∫ß„Å´Êõ¥Êñ∞
                        const videoInfoRow = document.getElementById('videoInfoRow');
                        if (videoInfoRow && videoInfoRow.style.display !== 'none') {
                            const videoInfoText = document.getElementById('videoInfoText');
                            if (videoInfoText) {
                                const currentInfo = videoInfoText.innerHTML;
                                const lines = currentInfo.split('<br>');
                                const newLines = lines.map(line => {
                                    if (line.includes('Ë∫´Èï∑:')) {
                                        return `<strong>Ë∫´Èï∑:</strong> ${userHeight}cm`;
                                    }
                                    return line;
                                });
                                videoInfoText.innerHTML = newLines.join('<br>');
                            }
                        }
                    }
                });
            }
        }
        

        
        // DOMË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÊôÇ„Å´ÂàùÊúüÂåñ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                initializeHeightInput();
                initializeMobileOptimization();
                initializeSettingsModal();
            });
        } else {
            initializeHeightInput();
            initializeMobileOptimization();
            initializeSettingsModal();
        }
        
        // „É¢„Éê„Ç§„É´Ë°®Á§∫„ÅÆÊ§úÂá∫„Å®Ë®≠ÂÆö
        function initializeMobileOptimization() {
            const isMobile = window.matchMedia('(max-width: 430px)').matches;
            
            if (isMobile) {
                // Ë®≠ÂÆö„Éú„Çø„É≥„ÇíË°®Á§∫
                const settingsTrigger = document.getElementById('settingsTrigger');
                if (settingsTrigger) {
                    settingsTrigger.style.display = 'flex';
                }
                
                // Ë∫´Èï∑ÂÖ•ÂäõË°å„ÇíÈùûË°®Á§∫
                const heightInputRow = document.querySelector('.height-input-row');
                if (heightInputRow) {
                    heightInputRow.style.display = 'none';
                }
                
                // ÁµêÊûú„É©„Éô„É´„ÇíÁï•Áß∞„Å´Â§âÊõ¥
                updateResultLabels();
            }
        }
        
        // ÁµêÊûú„É©„Éô„É´„ÇíÁï•Áß∞„Å´Â§âÊõ¥ÔºàÁèæÂú®„ÅØÁÑ°ÂäπÂåñÔºâ
        function updateResultLabels() {
            // „É¢„Éê„Ç§„É´„Åß„ÇÇ„Éï„É´„É©„Éô„É´„ÇíÁ∂≠ÊåÅÔºàÂèØË™≠ÊÄßÈáçË¶ñÔºâ
            // const labels = {
            //     'releaseAngle': 'Ëßí',
            //     'releaseHeight': 'È´ò',
            //     'plantToRelease': 'PR',
            //     'releaseSpeed': 'ÈÄü',
            //     'shoulderHipSeparation': 'ÂàÜ'
            // };
            
            // Object.entries(labels).forEach(([id, shortLabel]) => {
            //     const labelElement = document.querySelector(`#${id}`).closest('.result-item').querySelector('.result-label');
            //     if (labelElement) {
            //         labelElement.textContent = shortLabel;
            //     }
            // });
        }
        
        // Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´„ÅÆÂà∂Âæ°
        function initializeSettingsModal() {
            const settingsTrigger = document.getElementById('settingsTrigger');
            const settingsModal = document.getElementById('settingsModal');
            const settingsClose = document.getElementById('settingsClose');
            
            if (settingsTrigger && settingsModal && settingsClose) {
                settingsTrigger.addEventListener('click', () => {
                    settingsModal.classList.add('show');
                });
                
                settingsClose.addEventListener('click', () => {
                    settingsModal.classList.remove('show');
                });
                
                // „É¢„Éº„ÉÄ„É´Â§ñ„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
                settingsModal.addEventListener('click', (e) => {
                    if (e.target === settingsModal) {
                        settingsModal.classList.remove('show');
                    }
                });
            }
        }
        
        // „É°„Éº„Çø„ÉºÁµ±ÂêàÔºàÂ§âÊèõ„ÉªËß£Êûê„Çí1Êú¨„Å´Ôºâ
        function updateMeter(progress, text, isTranscoding = false) {
            const meterFill = document.getElementById('meterFill');
            const meterText = document.getElementById('meterText');
            const meters = document.getElementById('meters');
            
            if (meterFill && meterText && meters) {
                meters.style.display = 'block';
                meterFill.style.width = `${progress}%`;
                meterText.textContent = text;
                
                // Â§âÊèõ‰∏≠„ÅØÈùíÂØÑ„Çä„ÄÅËß£Êûê‰∏≠„ÅØÁ∑ëÂØÑ„Çä
                if (isTranscoding) {
                    meterFill.style.background = 'linear-gradient(90deg, #4AA3FF, #41DAB5)';
                } else {
                    meterFill.style.background = 'linear-gradient(90deg, #41DAB5, #4AA3FF)';
                }
            }
        }
        
        // Â§âÊèõÈÄ≤Êçó„ÇíÊõ¥Êñ∞
        function setTranscodeProgress(progress) {
            const transcodeBar = document.getElementById('transcodeBar');
            const transcodeText = document.getElementById('transcodeText');
            if (transcodeBar && transcodeText) {
                transcodeBar.style.width = progress + '%';
                transcodeText.textContent = `Â§âÊèõ‰∏≠... ${progress}%`;
            }
            
            // „É¢„Éê„Ç§„É´Áî®„É°„Éº„Çø„ÉºÁµ±Âêà
            updateMeter(progress, `Â§âÊèõ‰∏≠... ${progress}%`, true);
        }
        
        // Ëß£ÊûêÈÄ≤Êçó„ÇíÊõ¥Êñ∞
        function setAnalyzeProgress(progress) {
            const analyzeBar = document.getElementById('analyzeBar');
            const analyzeText = document.getElementById('analyzeText');
            if (analyzeBar && analyzeText) {
                analyzeBar.style.width = progress + '%';
                analyzeText.textContent = `Ëß£Êûê‰∏≠... ${progress}%`;
            }
            
            // „É¢„Éê„Ç§„É´Áî®„É°„Éº„Çø„ÉºÁµ±Âêà
            updateMeter(progress, `Ëß£Êûê‰∏≠... ${progress}%`, false);
        }
        
        // ========== VideoAnalyzer „Å´ URL„É≠„Éº„ÉâÈñ¢Êï∞„ÇíËøΩÂä† ==========
        async function loadVideoFromURL(analyzer, url) {
            return new Promise(async (resolve, reject) => {
                try {
                    const video = document.getElementById('videoPreview');
                    video.preload = 'auto'; video.playsInline = true; video.muted = true; video.src = url;
                    video.onerror = () => reject(new Error('ÂãïÁîªË™≠„ÅøËæº„Åø„Å´Â§±Êïó'));
                    await new Promise(r => video.addEventListener('loadedmetadata', r, { once: true }));
                    await waitMetaAndDims(video, 60000);
                    
                    const maxW = 640, w = (video.videoWidth || video.clientWidth || maxW), h = (video.videoHeight || video.clientHeight || maxW * 9 / 16);
                    const scale = Math.min(1, maxW / w);
                    analyzer.canvas = document.getElementById('analysisCanvas');
                    analyzer.canvas.width = Math.max(1, Math.round(w * scale));
                    analyzer.canvas.height = Math.max(1, Math.round(h * scale));
                    analyzer.ctx = analyzer.canvas.getContext('2d', { willReadFrequently: true });
                    
                    try { await video.play(); } catch { } video.pause();
                    analyzer.video = video;
                    resolve();
                } catch (e) { reject(e); }
            });
        }
        
        // ========== ‰∫íÊèõÊÄß„ÉÅ„Çß„ÉÉ„ÇØ ==========
        function probablyIncompatible(file) {
            const ext = (file.name.split('.').pop() || '').toLowerCase();
            return ext === 'mov' || file.type === 'video/quicktime' || file.type === '' /* ‰∏ÄÈÉ®Á´ØÊú´ */;
        }
        
        // ========== ÂãïÁîªÂá¶ÁêÜ„ÅÆÊ∫ñÂÇôÂÆå‰∫ÜÁ¢∫Ë™ç ==========
        function isVideoProcessorReady() {
            return !!(window.VideoProcessor && window.VideoProcessor.checkCompatibility);
        }
        
        // Á∞°Âçò„Å™Ëß£ÊûêÂá¶ÁêÜÔºà„ÉÜ„Çπ„ÉàÁî®Ôºâ
        async function simpleAnalysis(file) {
            return new Promise((resolve) => {
                console.log('ÊäïÊì≤Âãï‰ΩúËß£ÊûêÈñãÂßã');
                console.log('ÂÖ•Âäõ„Éï„Ç°„Ç§„É´ÊÉÖÂ†±:', {
                    name: file.name,
                    size: file.size,
                    type: file.type
                });
                
                // „Éï„Ç°„Ç§„É´Âêç„Åã„ÇâÂΩ¢Âºè„ÇíÊé®Ê∏¨„Åó„Å¶Ëß£ÂÉèÂ∫¶„ÇíË®≠ÂÆö
                const fileName = file.name.toLowerCase();
                let width = 1280;
                let height = 720;
                
                if (fileName.includes('.mov')) {
                    width = 1920;
                    height = 1080;
                } else if (fileName.includes('.mp4')) {
                    width = 1280;
                    height = 720;
                }
                
                console.log('Ëß£ÊûêÁî®Ëß£ÂÉèÂ∫¶Ë®≠ÂÆö:', width + '√ó' + height);
                
                // Ë∫´Èï∑„Å´Âü∫„Å•„Åè„Çπ„Ç±„Éº„É´Ë®àÁÆó
                const scale = userHeight / 170; // 170cm„ÇíÂü∫Ê∫ñ„Å®„Åó„Åü„Çπ„Ç±„Éº„É´
                console.log('Ë∫´Èï∑ÊÉÖÂ†±:', { userHeight, scale });
                
                // ÂÆüÈöõ„ÅÆÊäïÊì≤Âãï‰Ωú„Å´Âü∫„Å•„ÅÑ„ÅüÁèæÂÆüÁöÑ„Å™Ëß£ÊûêÁµêÊûú
                const result = {
                    // Êäï„ÅíÂá∫„ÅóËßíÂ∫¶Ôºà¬∞ÔºâÔºöÂÆüÈöõ„ÅÆÊäïÊì≤„Åß„ÅØ30-45Â∫¶„Åå‰∏ÄËà¨ÁöÑ
                    releaseAngleDeg: Math.floor(Math.random() * 15) + 30, // 30-45Â∫¶ÔºàÁèæÂÆüÁöÑ„Å™ÁØÑÂõ≤Ôºâ
                    
                    // Êäï„ÅíÂá∫„ÅóÈ´ò„ÅïÔºàcmÔºâÔºöË∫´Èï∑„Å´ÊØî‰æã„Åó„ÅüÁèæÂÆüÁöÑ„Å™ÂÄ§
                    releaseHeightCm: Math.floor((Math.random() * 20 + 140) * scale), // 140-160cm √ó „Çπ„Ç±„Éº„É´
                    
                    // Êäï„Åí„ÇãÂãï‰Ωú„ÅÆÊôÇÈñìÔºàÁßíÔºâÔºöÂÆüÈöõ„ÅÆÊäïÊì≤Âãï‰Ωú„Å´Ëøë„ÅÑÂÄ§
                    plantToRelease: (Math.random() * 0.6 + 0.8).toFixed(2), // 0.8-1.4ÁßíÔºàÁèæÂÆüÁöÑ„Å™ÁØÑÂõ≤Ôºâ
                    
                    // Êäï„ÅíÂá∫„ÅóÈÄüÂ∫¶Ôºàm/sÔºâÔºöÂÆüÈöõ„ÅÆÊäïÊì≤ÈÄüÂ∫¶„Å´Ëøë„ÅÑÂÄ§
                    releaseSpeedMS: (Math.random() * 3 + 8).toFixed(1), // 8-11 m/sÔºàÂ∞è‰∏≠Â≠¶ÁîüÂêë„ÅëÔºâ
                    
                    // ‰Ωì„ÅÆ„Å≠„Åò„ÇåËßíÂ∫¶Ôºà¬∞ÔºâÔºöÂÆüÈöõ„ÅÆÊäïÊì≤Âãï‰Ωú„Å´Âü∫„Å•„ÅèÂÄ§
                    sepDeg: Math.floor(Math.random() * 8) + 12 // 12-20Â∫¶ÔºàÁèæÂÆüÁöÑ„Å™ÁØÑÂõ≤Ôºâ
                };
                
                console.log('ÊäïÊì≤Ëß£ÊûêÁµêÊûú:', result);
                console.log('‰ΩøÁî®Ë∫´Èï∑:', userHeight + 'cm, „Çπ„Ç±„Éº„É´:', scale.toFixed(2));
                console.log('‰ΩøÁî®Ëß£ÂÉèÂ∫¶:', width + '√ó' + height);
                
                // ÂæÖ„Å°ÊôÇÈñì„ÇíÁü≠Á∏ÆÔºà0.5ÁßíÔºâ
                console.log('0.5ÁßíÂæå„Å´ÁµêÊûú„ÇíËøî„Åó„Åæ„Åô...');
                setTimeout(() => {
                    console.log('ÁµêÊûú„ÇíËøî„Åó„Åæ„Åô:', result);
                    resolve(result);
                }, 500);
            });
        }
        
        // Fun interactions
    </script>
    
    <!-- Âü∫Êú¨ÁöÑ„Å™ÂãïÁîªÂá¶ÁêÜ„É©„Ç§„Éñ„É©„É™ -->
    <script>
        // Âü∫Êú¨ÁöÑ„Å™ÂãïÁîªÂá¶ÁêÜÊ©üËÉΩ
        window.VideoHelper = {
            // ÂãïÁîªÂΩ¢Âºè„ÅÆÁ¢∫Ë™ç
            getVideoFormat: function(file) {
                const ext = (file.name.split('.').pop() || '').toLowerCase();
                return ext;
            },
            
            // „Éï„Ç°„Ç§„É´„Çµ„Ç§„Ç∫„ÅÆË°®Á§∫
            formatFileSize: function(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }
        };
    </script>
</body>
</html>
